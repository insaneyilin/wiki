<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
    <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>Git notes - Yilin's Wiki</title>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          <!--$表示行内元素，$$表示块状元素 -->
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

    <!--Mermaid流程图-->
    <script src="https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/wiki/">Home</a>&nbsp;&#187;&nbsp;<a href="/wiki/#tools">tools</a>&nbsp;&#187;&nbsp;Git notes
    <span class="updated">Page Updated&nbsp;
      2019-07-09 00:01
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">Git notes</div>

  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#git"><a name="gitconfig"></a>Git 配置</a></li>
<li><a href="#github-ssh-key">Github 配置 SSH Key</a><ul>
<li><a href="#1-git-username-e-mail">1. 设置 git 的 username 和 e-mail</a></li>
<li><a href="#2-ssh-key">2. 生成 ssh key</a></li>
<li><a href="#3-github-ssh-key">3. Github 添加 ssh key</a></li>
<li><a href="#4">4. 验证</a></li>
</ul>
</li>
<li><a href="#github-standard-fork-pull-request-workflow">GitHub Standard Fork &amp; Pull Request Workflow</a><ul>
<li><a href="#1-fork-repo">1. Fork 主 repo 到自己账户</a></li>
<li><a href="#2-fork">2. 保持远端的 Fork 与上游同步</a></li>
<li><a href="#3-feature">3. 创建分支开发新 feature</a></li>
<li><a href="#4-pull-request">4. 提交 Pull Request</a></li>
</ul>
</li>
<li><a href="#git-clone-depth1">git clone --depth=1 之后怎样获取其他分支？</a></li>
<li><a href="#repo-repo">本地 repo 关联到远端 repo</a></li>
</ul>
</div>
<h2 id="git"><a name="gitconfig"></a>Git 配置</h2>
<p>手动设置用户信息：</p>
<div class="hlcode"><pre><span></span><span class="n">git</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="c1">--global user.name &quot;ABC&quot;</span>
<span class="n">git</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="c1">--global user.email &quot;abc@abc.com&quot;</span>
</pre></div>


<p>使用配置文件，<code>vim ~/.gitconfig</code>：</p>
<div class="hlcode"><pre><span></span><span class="k">[user]</span>
    <span class="na">name</span> <span class="o">=</span> <span class="s">ABC</span>
<span class="s">    email = abc@abc.com</span>

<span class="k">[core]</span>
    <span class="na">editor</span> <span class="o">=</span> <span class="s">vim</span>

<span class="k">[alias]</span>
    <span class="na">st</span> <span class="o">=</span> <span class="s">status</span>
<span class="s">    br = branch</span>
<span class="s">    df = diff</span>
<span class="s">    l = log</span>
<span class="s">    lg = log --pretty=format:&#39;%Cred%h%Creset -%C(yellow)%d%Creset %s [%C(cyan)%an%Creset] %Cgreen(%cr)%Creset&#39; --graph --decorate</span>
<span class="s">    co = checkout</span>
</pre></div>


<hr />
<h2 id="github-ssh-key">Github 配置 SSH Key</h2>
<h3 id="1-git-username-e-mail">1. 设置 git 的 username 和 e-mail</h3>
<p>参考 <a href="#gitconfig">Git 配置</a>。</p>
<h3 id="2-ssh-key">2. 生成 ssh key</h3>
<div class="hlcode"><pre><span></span><span class="err">#</span><span class="w"> </span><span class="n">查看是否已存在</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="n">ls</span><span class="w"> </span><span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="o">*</span><span class="w"></span>

<span class="err">#</span><span class="w"> </span><span class="n">若没有</span><span class="err">，</span><span class="n">生成一个新的</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">rsa</span><span class="w"> </span><span class="o">-</span><span class="n">C</span><span class="w"> </span><span class="ss">&quot;abc@abc.com&quot;</span><span class="w"></span>

<span class="err">#</span><span class="w"> </span><span class="n">查看生成的</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="n">cat</span><span class="w"> </span><span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">.</span><span class="n">pub</span><span class="w"></span>
</pre></div>


<h3 id="3-github-ssh-key">3. Github 添加 ssh key</h3>
<p>在 Github 用户设置里将 <code>~/.ssh/id_rsa.pub</code> 中的内容贴上去。</p>
<h3 id="4">4. 验证</h3>
<div class="hlcode"><pre><span></span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">T</span><span class="w"> </span><span class="n">git</span><span class="nv">@github</span><span class="p">.</span><span class="n">com</span><span class="w"></span>
</pre></div>


<hr />
<h2 id="github-standard-fork-pull-request-workflow">GitHub Standard Fork &amp; Pull Request Workflow</h2>
<p>主要思想：从主 repo fork 到自己账户下，设置 upstream，保持 remote master 和 local master 干净，新 feature 在分支开发，开发完同步主 repo （merge, rebase …），从开发分支直接发 pull request 到主 repo。</p>
<p>有一点要注意，<strong>不要在 local master 分支上开发新 feature </strong>，否则同步远端 upstream 分支的时候会乱掉。</p>
<h3 id="1-fork-repo">1. Fork 主 repo 到自己账户</h3>
<div class="hlcode"><pre><span></span><span class="err">#</span><span class="w"> </span><span class="n">Clone</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">fork</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="k">local</span><span class="w"> </span><span class="n">machine</span><span class="w"></span>
<span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="n">git</span><span class="nv">@github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">USERNAME</span><span class="o">/</span><span class="n">FORKED</span><span class="o">-</span><span class="n">PROJECT</span><span class="p">.</span><span class="n">git</span><span class="w"></span>
</pre></div>


<h3 id="2-fork">2. 保持远端的 Fork 与上游同步</h3>
<div class="hlcode"><pre><span></span><span class="o">#</span> <span class="k">Add</span> <span class="s1">&#39;upstream&#39;</span> <span class="n">repo</span> <span class="k">to</span> <span class="n">list</span> <span class="k">of</span> <span class="n">remotes</span>
<span class="n">git</span> <span class="n">remote</span> <span class="k">add</span> <span class="n">upstream</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">UPSTREAM</span><span class="o">-</span><span class="k">USER</span><span class="o">/</span><span class="n">ORIGINAL</span><span class="o">-</span><span class="n">PROJECT</span><span class="p">.</span><span class="n">git</span>

<span class="o">#</span> <span class="n">Verify</span> <span class="n">the</span> <span class="k">new</span> <span class="n">remote</span> <span class="n">named</span> <span class="s1">&#39;upstream&#39;</span>
<span class="n">git</span> <span class="n">remote</span> <span class="o">-</span><span class="n">v</span>

<span class="o">#</span> <span class="k">Fetch</span> <span class="k">from</span> <span class="n">upstream</span> <span class="n">remote</span>
<span class="n">git</span> <span class="k">fetch</span> <span class="n">upstream</span>

<span class="o">#</span> <span class="k">View</span> <span class="k">all</span> <span class="n">branches</span><span class="p">,</span> <span class="k">including</span> <span class="n">those</span> <span class="k">from</span> <span class="n">upstream</span>
<span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">va</span>

<span class="o">#</span> <span class="n">Checkout</span> <span class="n">your</span> <span class="n">master</span> <span class="n">branch</span> <span class="k">and</span> <span class="n">merge</span> <span class="n">upstream</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
<span class="n">git</span> <span class="n">merge</span> <span class="n">upstream</span><span class="o">/</span><span class="n">master</span>
</pre></div>


<p>本地尽量不要用 master 开发，可以避免同步时出现冲突。</p>
<h3 id="3-feature">3. 创建分支开发新 feature</h3>
<p>如果要进行开发（new feature or bugfix），建议创建一个新的分支开发，如 <code>dev_xxx</code> 或者 <code>bugfix_xxx</code> 。这样能够最大程度的控制自己的修改，同时保证修改同 master 分支的隔离。</p>
<h3 id="4-pull-request">4. 提交 Pull Request</h3>
<p>先同步远端上游 master 到本地 master，再在开发分支上 rebase master，提 pr 的时候可以直接从分支提：</p>
<div class="hlcode"><pre><span></span># <span class="nv">Fetch</span> <span class="nv">upstream</span> <span class="nv">master</span> <span class="nv">and</span> <span class="nv">merge</span> <span class="nv">with</span> <span class="nv">your</span> <span class="nv">repo</span><span class="s1">&#39;</span><span class="s">s master branch</span>
<span class="nv">git</span> <span class="nv">fetch</span> <span class="nv">upstream</span>
<span class="nv">git</span> <span class="nv">checkout</span> <span class="nv">master</span>
<span class="nv">git</span> <span class="nv">merge</span> <span class="nv">upstream</span><span class="o">/</span><span class="nv">master</span>

# <span class="k">If</span> <span class="nv">there</span> <span class="nv">were</span> <span class="nv">any</span> <span class="nv">new</span> <span class="nv">commits</span>, <span class="nv">rebase</span> <span class="nv">your</span> <span class="nv">development</span> <span class="nv">branch</span>
<span class="nv">git</span> <span class="nv">checkout</span> <span class="nv">newfeature</span>
<span class="nv">git</span> <span class="nv">rebase</span> <span class="nv">master</span>
</pre></div>


<p>以上参考自 <a href="https://gist.github.com/Chaser324/ce0505fbed06b947d962">Chaser324/GitHub-Forking.md</a>。</p>
<hr />
<h2 id="git-clone-depth1">git clone --depth=1 之后怎样获取其他分支？</h2>
<div class="hlcode"><pre><span></span><span class="n">git</span> <span class="n">remote</span> <span class="k">set</span><span class="o">-</span><span class="n">branches</span> <span class="n">origin</span> <span class="o">&lt;</span><span class="n">remote_branch_name</span><span class="o">&gt;</span>
<span class="n">git</span> <span class="k">fetch</span> <span class="c1">--depth 1 origin &lt;remote_branch_name&gt;</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="o">&lt;</span><span class="n">remote_branch_name</span><span class="o">&gt;</span>
</pre></div>


<hr />
<h2 id="repo-repo">本地 repo 关联到远端 repo</h2>
<div class="hlcode"><pre><span></span><span class="nv">git</span> <span class="nv">remote</span> <span class="nv">add</span> <span class="nv">origin</span> <span class="nv">git</span>@<span class="nv">github</span>.<span class="nv">com</span>:<span class="nv">your_name</span><span class="o">/</span><span class="nv">your_project</span>.<span class="nv">git</span>
<span class="nv">git</span> <span class="nv">remote</span> <span class="k">show</span> <span class="nv">origin</span>

<span class="nv">git</span> <span class="nv">branch</span> <span class="o">--</span><span class="nv">set</span><span class="o">-</span><span class="nv">upstream</span><span class="o">-</span><span class="nv">to</span><span class="o">=</span><span class="nv">origin</span><span class="o">/&lt;</span><span class="nv">branch</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nv">local_branch</span><span class="o">&gt;</span>
</pre></div>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2019 Yilin Gui.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2019-11-22 01:12:02</p>
      </span>
    </div>

    
    
  </body>
</html>